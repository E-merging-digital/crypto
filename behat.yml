default:
  suites:
    default:
      paths:
        - tests/behat/features
      contexts:
        - 'App\Tests\Behat\FeatureContext'
        - 'Drupal\DrupalExtension\Context\MinkContext'
        - 'Drupal\DrupalExtension\Context\DrupalContext'

  extensions:
    Behat\MinkExtension:
      # Session par défaut rapide (BrowserKit) + session JS via Selenium
      default_session: symfony
      javascript_session: selenium2

      # Valeur par défaut pour l'exécution en conteneur (DDEV/compose)
      base_url: 'http://web'

      sessions:
        symfony:
          browserkit_http: ~
        selenium2:
          selenium2:
            wd_host: 'http://selenium:4444/wd/hub'
            browser: chrome
            capabilities:
              acceptSslCerts: true
              chrome:
                switches:
                  - "--headless=new"
                  - "--disable-gpu"
                  - "--no-sandbox"
                  - "--window-size=1920,1080"

    Drupal\DrupalExtension:
      api_driver: 'drupal'
      drupal:
        drupal_root: '%paths.base%/web'

ddev:
  extensions:
    Behat\MinkExtension:
      base_url: 'http://web'
      sessions:
        symfony:
          browserkit_http: ~
        selenium2:
          selenium2:
            wd_host: 'http://selenium:4444/wd/hub'
            browser: chrome
            capabilities:
              acceptSslCerts: true
              chrome:
                switches:
                  - "--headless=new"
                  - "--disable-gpu"
                  - "--no-sandbox"
                  - "--window-size=1920,1080"

ci:
  extensions:
    Behat\MinkExtension:
      # CI GitHub: serveur PHP intégré exposé en local
      base_url: 'http://127.0.0.1:8081'
      sessions:
        symfony:
          browserkit_http: ~
        selenium2:
          selenium2:
            # Selenium lancé sur le runner (pas de service "web" en réseau docker-compose)
            wd_host: 'http://127.0.0.1:4444/wd/hub'
            browser: chrome
            capabilities:
              acceptSslCerts: true
              chrome:
                switches:
                  - "--headless=new"
                  - "--disable-gpu"
                  - "--no-sandbox"
                  - "--window-size=1920,1080"
